# Структура проекта Asp MVC, Модульность
## Введение
Мы начали переписывать старые десктопные приложения на веб-версии.
Чтобы новые веб-проекты оставались понятными и удобными для поддержки,
необходимо разработать шаблон структуры проекта. Это поможет организовать
хранение файлов по папкам и разделить функционал приложения
по проектам (UI, Store, сервисы и т.д.). Для первых этапов разработки и
эксплуатации новых программ предлагается использовать классическую архитектуру ASP.NET MVC.

## Полезные статьи
- [Общие сведения ASP.NET Core MVC](https://learn.microsoft.com/ru-ru/aspnet/core/mvc/overview?view=aspnetcore-8.0)
- [Структура «Feature Folders» в ASP.NET Core MVC](https://habr.com/ru/articles/321392/)

## Структура
Перед тем как ознакомиться с этим разделом, рекомендуется изучить Полезные статьи.

Теперь перейдем к практике.

Пример структуры приложения

![image](https://github.com/user-attachments/assets/698758e8-f3a2-4963-a805-1a104492093c)

Ключевыми папками здесь являются Controllers, Models и Views.

### Рекомендации
#### Models - Для улучшения читабельности рекомендуется создавать подпапки для каждой сущности, связанной с контроллером. Это предотвратит путаницу в моделях.
#### Views:
- Все view-файлы должны храниться в подпапках, соответствующих контроллерам.
- Общие или базовые view-файлы лучше поместить в отдельную папку Base.

#### Разделение файла Program.cs
Для удобства конфигурации и улучшения читаемости можно разбить файл Program.cs на два:
- Program.cs - файл, где создается и запускается экземпляр ```WebApplication```

![image](https://github.com/user-attachments/assets/02de9ad6-9e02-4865-b792-65486c937a7e)
  
- StartUp.cs - файл, где происходит конфигурация приложения (маршруты, зависимости, сервисы и т.д.).

![image](https://github.com/user-attachments/assets/dca992f5-335e-440f-b159-10f9257c4fca)

#### Передача данных в views:
- В методе контроллера получаем данные и передаем их в view через модель.

![image](https://github.com/user-attachments/assets/7155496a-d6ad-4647-81aa-7c57c2332b26)

В view эти данные доступны через объект модели.

![image](https://github.com/user-attachments/assets/73731511-4114-46fb-b890-7326a4f1d523)

- Использование AJAX

Этот подход позволяет загружать данные без полной перезагрузки страницы, что ускоряет и улучшает взаимодействие с пользователем.

Кейс применения: на странице Main отображается таблица с данными. Для редактирования записи открывается модальное окно или происходит переход на другой URL. Параметр id передается, и через AJAX загружаются все необходимые данные по этой записи.

Пример реализации:
Создаем метод контроллера для обработки AJAX-запроса. Рекомендуется в имени метода указывать суффикс "Ajax", чтобы было ясно, что метод вызывается через скрипт.

![image](https://github.com/user-attachments/assets/5d21b8a4-8a5a-4144-ba7e-78f3586a3f92)

Изменяем разметку view для поддержки загрузки данных через AJAX.

![image](https://github.com/user-attachments/assets/6c4347ed-8b4c-45f5-a6e0-1c7436f183ba)

## Модульность
Модульность в данном контексте подразумевает разделение функциональности на отдельные библиотеки. Решение о том, создавать ли отдельный проект или локализовать всё в одном проекте, принимается индивидуально в зависимости от объема и сложности функционала.

Общий подход таков: весь бизнес-логика выносится в сервисы. Сервисы описываются через интерфейсы, например, IUserService, где определяются сигнатуры методов. Реализация интерфейсов осуществляется в классах, таких как UserService, которые затем регистрируются в системе внедрения зависимостей (DI). В контроллерах используются интерфейсы сервисов, чтобы обеспечить гибкость и возможность замены реализации.

При небольшой функциональности можно ограничиться одним проектом, структурировав его в виде папок (например, Services, Infrastructure, Data и другие). Если же функционал значителен и разнообразен, целесообразно вынести его в отдельные проекты. Эти проекты инжектируются в основной через расширения (extensions) для IServiceCollection и подключаются в StartUp исполняемого проекта.

### Создаем сервис
- Определяем сигнатуры методов интерфейса

![image](https://github.com/user-attachments/assets/536dfe76-343e-457a-9d06-a52e13b028e8)

- Создадим класс с реализацией данного интерфейса

![image](https://github.com/user-attachments/assets/5b8ebfd6-4413-473d-9178-110fdca8109c)

- Добавим в DI данный интерфейс с реализацией

![image](https://github.com/user-attachments/assets/a4e638d9-45eb-4ff3-8367-2fe3d1fd6daa)

- Вызовим интерфейс в контроллере и получим данные

![image](https://github.com/user-attachments/assets/9463756d-4d6d-4ec0-989b-90f089dd90e0)

**Готово!**

